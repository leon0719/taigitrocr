nohup: ignoring input
train.py:73: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  cer_metric = load_metric("cer")
Using cuda_amp half precision backend
/home/leon/trocr/ocr/lib/python3.8/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 36000
  Num Epochs = 10
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 160
  Gradient Accumulation steps = 1
  Total optimization steps = 2250
  Number of trainable parameters = 384864768
train param
Namespace(checkpoint_path='./checkpoint/trocr', dataset_path='tools/train_data/image', eval_steps=500, max_target_length=128, num_train_epochs=10, per_device_eval_batch_size=8, per_device_train_batch_size=16, save_steps=1000, train_label_text_path='tools/train_data/train_label.txt', valid_label_text_path='tools/train_data/valid_label.txt')
loading data .................
train num: 36000 test num: 4000
  0%|          | 0/2250 [00:00<?, ?it/s]