nohup: ignoring input
train.py:73: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library ðŸ¤— Evaluate: https://huggingface.co/docs/evaluate
  cer_metric = load_metric("cer")
Using cuda_amp half precision backend
/home/leon/trocr/ocr/lib/python3.8/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 36000
  Num Epochs = 10
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 160
  Gradient Accumulation steps = 1
  Total optimization steps = 2250
  Number of trainable parameters = 384864768
train param
Namespace(checkpoint_path='./checkpoint/trocr', dataset_path='tools/train_data/image', eval_steps=500, max_target_length=128, num_train_epochs=10, per_device_eval_batch_size=16, per_device_train_batch_size=16, save_steps=1000, train_label_text_path='tools/train_data/train_label.txt', valid_label_text_path='tools/train_data/valid_label.txt')
loading data .................
train num: 36000 test num: 4000
  0%|          | 0/2250 [00:00<?, ?it/s]/home/leon/trocr/ocr/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  0%|          | 1/2250 [00:48<30:14:33, 48.41s/it]  0%|          | 2/2250 [00:54<14:46:51, 23.67s/it]  0%|          | 3/2250 [01:00<9:43:02, 15.57s/it]   0%|          | 4/2250 [01:06<7:20:33, 11.77s/it]  0%|          | 5/2250 [01:12<5:59:52,  9.62s/it]  0%|          | 6/2250 [01:18<5:12:10,  8.35s/it]  0%|          | 7/2250 [01:24<4:40:28,  7.50s/it]  0%|          | 8/2250 [01:30<4:22:07,  7.01s/it]  0%|          | 9/2250 [01:35<4:08:28,  6.65s/it]  0%|          | 10/2250 [01:41<3:59:52,  6.43s/it]                                                     0%|          | 10/2250 [01:41<3:59:52,  6.43s/it]  0%|          | 11/2250 [01:47<3:52:45,  6.24s/it]  1%|          | 12/2250 [01:53<3:48:11,  6.12s/it]  1%|          | 13/2250 [01:59<3:46:42,  6.08s/it]  1%|          | 14/2250 [02:05<3:44:06,  6.01s/it]  1%|          | 15/2250 [02:11<3:42:27,  5.97s/it]  1%|          | 16/2250 [02:16<3:40:02,  5.91s/it]  1%|          | 17/2250 [02:22<3:38:11,  5.86s/it]  1%|          | 18/2250 [02:28<3:38:43,  5.88s/it]  1%|          | 19/2250 [02:34<3:37:49,  5.86s/it]  1%|          | 20/2250 [02:40<3:37:26,  5.85s/it]                                                     1%|          | 20/2250 [02:40<3:37:26,  5.85s/it]  1%|          | 21/2250 [02:46<3:36:39,  5.83s/it]  1%|          | 22/2250 [02:51<3:36:38,  5.83s/it]  1%|          | 23/2250 [02:57<3:35:36,  5.81s/it]  1%|          | 24/2250 [03:03<3:37:50,  5.87s/it]  1%|          | 25/2250 [03:09<3:37:21,  5.86s/it]  1%|          | 26/2250 [03:15<3:36:26,  5.84s/it]  1%|          | 27/2250 [03:21<3:36:22,  5.84s/it]  1%|          | 28/2250 [03:26<3:35:50,  5.83s/it]  1%|â–         | 29/2250 [03:32<3:36:32,  5.85s/it]  1%|â–         | 30/2250 [03:38<3:36:10,  5.84s/it]                                                     1%|â–         | 30/2250 [03:38<3:36:10,  5.84s/it]  1%|â–         | 31/2250 [03:44<3:36:09,  5.84s/it]  1%|â–         | 32/2250 [03:50<3:37:02,  5.87s/it]  1%|â–         | 33/2250 [03:56<3:36:26,  5.86s/it]  2%|â–         | 34/2250 [04:02<3:37:02,  5.88s/it]  2%|â–         | 35/2250 [04:08<3:37:15,  5.89s/it]  2%|â–         | 36/2250 [04:13<3:37:00,  5.88s/it]  2%|â–         | 37/2250 [04:19<3:36:38,  5.87s/it]  2%|â–         | 38/2250 [04:25<3:35:24,  5.84s/it]  2%|â–         | 39/2250 [04:31<3:35:48,  5.86s/it]  2%|â–         | 40/2250 [04:37<3:35:22,  5.85s/it]                                                     2%|â–         | 40/2250 [04:37<3:35:22,  5.85s/it]  2%|â–         | 41/2250 [04:43<3:35:27,  5.85s/it]  2%|â–         | 42/2250 [04:48<3:34:46,  5.84s/it]  2%|â–         | 43/2250 [04:54<3:34:40,  5.84s/it]  2%|â–         | 44/2250 [05:00<3:34:54,  5.85s/it]  2%|â–         | 45/2250 [05:06<3:34:24,  5.83s/it]  2%|â–         | 46/2250 [05:12<3:35:03,  5.85s/it]  2%|â–         | 47/2250 [05:18<3:34:48,  5.85s/it]  2%|â–         | 48/2250 [05:24<3:34:52,  5.85s/it]  2%|â–         | 49/2250 [05:29<3:34:18,  5.84s/it]  2%|â–         | 50/2250 [05:35<3:33:38,  5.83s/it]                                                     2%|â–         | 50/2250 [05:35<3:33:38,  5.83s/it]  2%|â–         | 51/2250 [05:41<3:34:31,  5.85s/it]  2%|â–         | 52/2250 [05:47<3:33:58,  5.84s/it]  2%|â–         | 53/2250 [05:53<3:37:27,  5.94s/it]  2%|â–         | 54/2250 [05:59<3:36:40,  5.92s/it]  2%|â–         | 55/2250 [06:05<3:37:47,  5.95s/it]  2%|â–         | 56/2250 [06:11<3:36:40,  5.93s/it]  3%|â–Ž         | 57/2250 [06:17<3:35:00,  5.88s/it]  3%|â–Ž         | 58/2250 [06:23<3:35:09,  5.89s/it]  3%|â–Ž         | 59/2250 [06:29<3:36:20,  5.92s/it]  3%|â–Ž         | 60/2250 [06:34<3:35:39,  5.91s/it]                                                     3%|â–Ž         | 60/2250 [06:34<3:35:39,  5.91s/it]  3%|â–Ž         | 61/2250 [06:40<3:35:16,  5.90s/it]  3%|â–Ž         | 62/2250 [06:46<3:34:46,  5.89s/it]  3%|â–Ž         | 63/2250 [06:52<3:34:51,  5.89s/it]  3%|â–Ž         | 64/2250 [06:58<3:35:53,  5.93s/it]  3%|â–Ž         | 65/2250 [07:04<3:36:03,  5.93s/it]  3%|â–Ž         | 66/2250 [07:10<3:37:04,  5.96s/it]  3%|â–Ž         | 67/2250 [07:16<3:36:42,  5.96s/it]  3%|â–Ž         | 68/2250 [07:22<3:35:08,  5.92s/it]  3%|â–Ž         | 69/2250 [07:28<3:33:06,  5.86s/it]  3%|â–Ž         | 70/2250 [07:33<3:32:59,  5.86s/it]                                                     3%|â–Ž         | 70/2250 [07:33<3:32:59,  5.86s/it]  3%|â–Ž         | 71/2250 [07:39<3:33:36,  5.88s/it]  3%|â–Ž         | 72/2250 [07:45<3:33:35,  5.88s/it]  3%|â–Ž         | 73/2250 [07:51<3:33:02,  5.87s/it]  3%|â–Ž         | 74/2250 [07:57<3:31:42,  5.84s/it]  3%|â–Ž         | 75/2250 [08:03<3:32:30,  5.86s/it]  3%|â–Ž         | 76/2250 [08:09<3:33:11,  5.88s/it]  3%|â–Ž         | 77/2250 [08:15<3:32:56,  5.88s/it]  3%|â–Ž         | 78/2250 [08:20<3:32:24,  5.87s/it]  4%|â–Ž         | 79/2250 [08:26<3:33:53,  5.91s/it]  4%|â–Ž         | 80/2250 [08:32<3:32:31,  5.88s/it]                                                     4%|â–Ž         | 80/2250 [08:32<3:32:31,  5.88s/it]  4%|â–Ž         | 81/2250 [08:38<3:31:47,  5.86s/it]  4%|â–Ž         | 82/2250 [08:44<3:31:35,  5.86s/it]  4%|â–Ž         | 83/2250 [08:50<3:30:45,  5.84s/it]  4%|â–Ž         | 84/2250 [08:56<3:31:40,  5.86s/it]  4%|â–         | 85/2250 [09:01<3:31:03,  5.85s/it]  4%|â–         | 86/2250 [09:07<3:31:22,  5.86s/it]  4%|â–         | 87/2250 [09:13<3:31:34,  5.87s/it]  4%|â–         | 88/2250 [09:19<3:30:33,  5.84s/it]  4%|â–         | 89/2250 [09:25<3:33:19,  5.92s/it]  4%|â–         | 90/2250 [09:31<3:31:07,  5.86s/it]                                                     4%|â–         | 90/2250 [09:31<3:31:07,  5.86s/it]  4%|â–         | 91/2250 [09:37<3:33:05,  5.92s/it]  4%|â–         | 92/2250 [09:43<3:32:17,  5.90s/it]  4%|â–         | 93/2250 [09:49<3:31:36,  5.89s/it]  4%|â–         | 94/2250 [09:55<3:32:38,  5.92s/it]  4%|â–         | 95/2250 [10:00<3:30:51,  5.87s/it]  4%|â–         | 96/2250 [10:06<3:30:52,  5.87s/it]  4%|â–         | 97/2250 [10:12<3:29:29,  5.84s/it]  4%|â–         | 98/2250 [10:18<3:29:50,  5.85s/it]  4%|â–         | 99/2250 [10:24<3:29:18,  5.84s/it]  4%|â–         | 100/2250 [10:29<3:28:30,  5.82s/it]                                                      4%|â–         | 100/2250 [10:29<3:28:30,  5.82s/it]  4%|â–         | 101/2250 [10:35<3:29:16,  5.84s/it]  5%|â–         | 102/2250 [10:41<3:28:26,  5.82s/it]  5%|â–         | 103/2250 [10:47<3:29:01,  5.84s/it]  5%|â–         | 104/2250 [10:53<3:27:34,  5.80s/it]  5%|â–         | 105/2250 [10:58<3:26:29,  5.78s/it]  5%|â–         | 106/2250 [11:04<3:28:12,  5.83s/it]  5%|â–         | 107/2250 [11:10<3:28:56,  5.85s/it]  5%|â–         | 108/2250 [11:16<3:30:58,  5.91s/it]  5%|â–         | 109/2250 [11:22<3:30:58,  5.91s/it]  5%|â–         | 110/2250 [11:28<3:31:33,  5.93s/it]                                                      5%|â–         | 110/2250 [11:28<3:31:33,  5.93s/it]  5%|â–         | 111/2250 [11:34<3:30:36,  5.91s/it]  5%|â–         | 112/2250 [11:40<3:29:17,  5.87s/it]  5%|â–Œ         | 113/2250 [11:46<3:30:25,  5.91s/it]  5%|â–Œ         | 114/2250 [11:52<3:29:43,  5.89s/it]  5%|â–Œ         | 115/2250 [11:58<3:29:45,  5.89s/it]  5%|â–Œ         | 116/2250 [12:04<3:29:54,  5.90s/it]  5%|â–Œ         | 117/2250 [12:09<3:29:06,  5.88s/it]  5%|â–Œ         | 118/2250 [12:15<3:27:49,  5.85s/it]  5%|â–Œ         | 119/2250 [12:21<3:26:56,  5.83s/it]  5%|â–Œ         | 120/2250 [12:27<3:27:41,  5.85s/it]                                                      5%|â–Œ         | 120/2250 [12:27<3:27:41,  5.85s/it]  5%|â–Œ         | 121/2250 [12:33<3:26:42,  5.83s/it]  5%|â–Œ         | 122/2250 [12:38<3:27:13,  5.84s/it]  5%|â–Œ         | 123/2250 [12:44<3:26:10,  5.82s/it]  6%|â–Œ         | 124/2250 [12:50<3:24:51,  5.78s/it]  6%|â–Œ         | 125/2250 [12:56<3:25:29,  5.80s/it]  6%|â–Œ         | 126/2250 [13:02<3:25:16,  5.80s/it]  6%|â–Œ         | 127/2250 [13:08<3:26:47,  5.84s/it]  6%|â–Œ         | 128/2250 [13:13<3:26:18,  5.83s/it]  6%|â–Œ         | 129/2250 [13:19<3:26:18,  5.84s/it]  6%|â–Œ         | 130/2250 [13:25<3:25:37,  5.82s/it]                                                      6%|â–Œ         | 130/2250 [13:25<3:25:37,  5.82s/it]  6%|â–Œ         | 131/2250 [13:31<3:26:29,  5.85s/it]  6%|â–Œ         | 132/2250 [13:37<3:26:38,  5.85s/it]  6%|â–Œ         | 133/2250 [13:42<3:25:12,  5.82s/it]  6%|â–Œ         | 134/2250 [13:48<3:25:50,  5.84s/it]  6%|â–Œ         | 135/2250 [13:54<3:24:20,  5.80s/it]  6%|â–Œ         | 136/2250 [14:00<3:24:16,  5.80s/it]  6%|â–Œ         | 137/2250 [14:06<3:25:25,  5.83s/it]  6%|â–Œ         | 138/2250 [14:11<3:24:01,  5.80s/it]  6%|â–Œ         | 139/2250 [14:17<3:24:54,  5.82s/it]  6%|â–Œ         | 140/2250 [14:23<3:25:22,  5.84s/it]                                                      6%|â–Œ         | 140/2250 [14:23<3:25:22,  5.84s/it]